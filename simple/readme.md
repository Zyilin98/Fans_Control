# 适用于 ESP32-C3 的 风扇测试系统

## 项目简介

这是一个基于 ESP32-C3 开发板的风扇测试系统，具备以下功能：

  * 通过 PWM 信号调节风扇转速，支持按键和串口两种控制方式
  * 利用风扇的 TACH 信号检测转速并实时显示在 OLED 屏幕上
  * 具备防烧屏功能，30 秒无操作后自动关闭 OLED 显示屏

## 硬件连接

### 开发板

项目基于 **ESP32-C3 Dev Module** 开发板。

---

### 连接说明

| 组件         | ESP32-C3 引脚   | 说明                                   |
|--------------|----------------|--------------------------------------|
| 向上按钮     | GPIO0          | 用于增加 PWM 占空比，从而提高风扇转速           |
| 向下按钮     | GPIO1          | 用于减少 PWM 占空比，从而降低风扇转速           |
| 风扇 TACH    | GPIO2          | 用于接收风扇的转速检测脉冲信号                 |
| 风扇 PWM 控制 | GPIO3          | 用于输出 PWM 信号控制风扇转速                  |
| OLED SDA     | GPIO8          | OLED 显示屏的 SDA 引脚，用于数据传输            |
| OLED SCL     | GPIO9          | OLED 显示屏的 SCL 引脚，用于时钟信号传输         |

## 软件依赖

本项目使用了以下 Arduino 库：

  * **Wire** ：用于 I2C 通信，连接 OLED 显示屏。
  * **Adafruit_GFX** ：Adafruit 的图形库，用于在 OLED 上绘制图形和文字。
  * **Adafruit_SSD1306** ：用于控制 SSD1306 型 OLED 显示屏。

您可以通过 Arduino IDE 的库管理器搜索并安装这些库。

## 使用说明

  1. **上传代码** ：将代码复制到 Arduino IDE 中，选择正确的开发板型号（ESP32-C3 Dev Module）和端口，然后上传代码。
  2. **按键控制** ：按下向上按钮（GPIO0）可以增加 PWM 占空比（每次增加 10%，超过 100% 重置为 0%），按下向下按钮（GPIO1）可以减少 PWM 占空比（每次减少 10%，低于 0 重置为 100%）。
  3. **串口控制** ：通过串口监视器发送一个 0 - 100 的整数值，可以直接设置 PWM 占空比。
  4. **查看转速** ：OLED 显示屏会实时显示当前风扇转速（RPM）和 PWM 占空比。30 秒内无任何操作时，OLED 屏幕会自动关闭以防止烧屏。

## 注意事项

  * PWM 频率设置为 25000Hz，分辨率设置为 8 位，这些参数适用于大多数风扇，但您可能需要根据实际风扇调整。
  * 按键的消抖延时设置为 50ms，若按键灵敏度过高或过低，可调整代码中对应 delay(50) 的值。
  * 风扇每转产生的脉冲数（PULSES_PER_REV）在代码中默认设置为 2，您需要根据实际风扇的数据手册进行调整。
